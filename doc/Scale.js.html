<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: charts/Scale.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="insight#findMax">
            <span class="title">
                <a href="insight.html#findMax">insight#findMax</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="insight#findMax">
            <span class="title">
                <a href="insight.html#findMax">insight#findMax</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="insight#tickRotation">
            <span class="title">
                <a href="insight_tickRotation.html">insight#tickRotation</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Scale.js.html">Source: charts/Scale.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>insight.Scale = function Scale(chart, title, direction, type) {
    var ordered = d3.functor(false);
    var self = this;

    this.scale = type.scale();

    this.rangeType = this.scale.rangeRoundBands ? this.scale.rangeRoundBands : this.scale.rangeRound;

    this.series = [];
    this.title = title;
    this.chart = chart;
    this.type = type;
    this.direction = direction;
    this.bounds = [];

    chart.scales()
        .push(this);

    this.domain = function() {
        if (type.name == insight.Scales.Linear.name) {
            return [0, this.findMax()];
        } else if (type.name == insight.Scales.Ordinal.name) {
            return this.findOrdinalValues();
        } else if (type.name == insight.Scales.Time.name) {
            return [this.minTime(), this.maxTime()];
        }
    };

    this.calculateBounds = function() {
        var bounds = [];

        if (self.horizontal()) {
            bounds[0] = 0;
            bounds[1] = self.chart.width() - self.chart.margin()
                .right - self.chart.margin()
                .left;
        } else if (self.vertical()) {
            bounds[0] = self.chart.height() - self.chart.margin()
                .top - self.chart.margin()
                .bottom;
            bounds[1] = 0;

        }
        return bounds;
    };

    this.minTime = function() {
        // start at the largest time, and work back from there to find the minimum
        var minTime = new Date(8640000000000000);

        this.series.map(function(series) {
            var cMin = d3.min(series.keys());
            minTime = cMin &lt; minTime ? cMin : minTime;
        });
        return minTime;
    };


    this.maxTime = function() {
        // start at the smallest time, and work back from there to find the minimum
        var maxTime = new Date(-8640000000000000);

        this.series.map(function(series) {
            var cMax = d3.max(series.keys());
            maxTime = cMax > maxTime ? cMax : maxTime;
        });

        return maxTime;
    };

    this.findOrdinalValues = function() {
        var vals = [];

        this.series.map(function(series) {
            vals = series.keys();
        });

        return vals;
    };

    this.horizontal = function() {
        return this.direction == 'h';
    };

    this.vertical = function() {
        return this.direction == 'v';
    };

    this.findMax = function() {
        var max = 0;

        this.series.map(function(series) {
            var m = series.findMax(self);

            max = m > max ? m : max;
        });

        return max;
    };

    this.addSeries = function(series) {
        this.series.push(series);
    };

    /**
     * calculates the domain and output range of the d3 scale used by this Scale
     * @param {object[]} data - Description
     */
    this.initialize = function() {
        this.applyScaleRange.call(this.scale.domain(this.domain()), this.rangeType);
    };

    this.calculateRange = function() {
        this.scale.domain(this.domain());
    };

    this.applyScaleRange = function(rangeType) {
        var bounds = self.calculateBounds();

        self.bounds = bounds;

        rangeType.apply(this, [
            bounds, self.chart.barPadding()
        ]);
    };

    this.ordered = function(_) {
        if (!arguments.length) {
            return ordered();
        }
        ordered = d3.functor(_);
        return this;
    };
};
</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>.
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
