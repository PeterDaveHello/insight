<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: charts/Chart.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html"></a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="Dashboard">
            <span class="title">
                <a href="Dashboard.html">Dashboard</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Dashboard#addData"><a href="Dashboard.html#addData">addData</a></li>
            
                <li data-name="Dashboard#group"><a href="Dashboard.html#group">group</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="DataSet">
            <span class="title">
                <a href="DataSet.html">DataSet</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Dimension">
            <span class="title">
                <a href="Dimension.html">Dimension</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="findMax">
            <span class="title">
                <a href="findMax.html">findMax</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="findMax">
            <span class="title">
                <a href="findMax.html">findMax</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Grouping">
            <span class="title">
                <a href="Grouping.html">Grouping</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Grouping#computeFunction"><a href="Grouping.html#computeFunction">computeFunction</a></li>
            
                <li data-name="Grouping#count"><a href="Grouping.html#count">count</a></li>
            
                <li data-name="Grouping#cumulative"><a href="Grouping.html#cumulative">cumulative</a></li>
            
                <li data-name="Grouping#filter"><a href="Grouping.html#filter">filter</a></li>
            
                <li data-name="Grouping#getData"><a href="Grouping.html#getData">getData</a></li>
            
                <li data-name="Grouping#getOrderedData"><a href="Grouping.html#getOrderedData">getOrderedData</a></li>
            
                <li data-name="Grouping#initialize"><a href="Grouping.html#initialize">initialize</a></li>
            
                <li data-name="Grouping#mean"><a href="Grouping.html#mean">mean</a></li>
            
                <li data-name="Grouping#ordered"><a href="Grouping.html#ordered">ordered</a></li>
            
                <li data-name="Grouping#orderFunction"><a href="Grouping.html#orderFunction">orderFunction</a></li>
            
                <li data-name="Grouping#recalculate"><a href="Grouping.html#recalculate">recalculate</a></li>
            
                <li data-name="Grouping#reduceMultiDimension"><a href="Grouping.html#reduceMultiDimension">reduceMultiDimension</a></li>
            
                <li data-name="Grouping#sum"><a href="Grouping.html#sum">sum</a></li>
            
                <li data-name="Grouping#unique"><a href="Grouping.html#unique">unique</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="Chart.js.html">Source: charts/Chart.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>function Chart(name, element, dimension) {

    this.name = name;
    this.element = element;
    this.dimension = dimension;

    var height = d3.functor(300);
    var width = d3.functor(300);
    var zoomable = false;
    var zoomScale = null;
    this.container = null;

    this.chart = null;

    this.measureCanvas = document.createElement("canvas");

    this._margin = {
        top: 0,
        left: 0,
        right: 0,
        bottom: 0
    };

    var series = [];
    var scales = [];
    var axes = [];
    var self = this;
    var barPadding = d3.functor(0.1);
    var title = "";
    var autoMargin = false;


    this.addAxis = function(axis) {
        axes.push(axis);
    };

    this.axes = function() {
        return axes;
    };

    this.addClipPath = function() {
        this.chart.append("clipPath")
            .attr("id", this.clipPath())
            .append("rect")
            .attr("x", 1)
            .attr("y", 0)
            .attr("width", this.width() - this.margin()
                .left - this.margin()
                .right)
            .attr("height", this.height() - this.margin()
                .top - this.margin()
                .bottom);
    };

    this.init = function(create, container) {

        if (autoMargin) {
            this.calculateLabelMargin();
        }

        this.container = create ? d3.select(container)
            .append('div') : d3.select(this.element)
            .append('div');

        this.container
            .attr('class', InsightConstants.ContainerClass)
            .style('width', this.width() + 'px')
            .style('position', 'relative')
            .style('display', 'inline-block');

        this.chartSVG = this.container
            .append("svg")
            .attr("class", InsightConstants.ChartSVG)
            .attr("width", this.width())
            .attr("height", this.height());

        this.chart = this.chartSVG.append("g")
            .attr('class', InsightConstants.Chart)
            .attr("transform", "translate(" + this.margin()
                .left + "," + this.margin()
                .top + ")");

        this.addClipPath();

        scales.map(function(scale) {
            scale.initialize();
        });

        axes.map(function(axis) {
            axis.initialize();
            var a = axis.scale.domain();
        });

        if (zoomable) {
            this.initZoom();
        }

        this.tooltip();

        this.draw(false);
    };

    this.resizeChart = function() {
        this.container.style('width', this.width() + "px");

        this.chartSVG
            .attr("width", this.width())
            .attr("height", this.height());

        this.chart = this.chart
            .attr("transform", "translate(" + this.margin()
                .left + "," + this.margin()
                .top + ")");

        this.chart.select("#" + this.clipPath())
            .append("rect")
            .attr("x", 1)
            .attr("y", 0)
            .attr("width", this.width() - this.margin()
                .left - this.margin()
                .right)
            .attr("height", this.height() - this.margin()
                .top - this.margin()
                .bottom);
    };

    this.draw = function(dragging) {
        this.resizeChart();

        this.recalculateScales();

        axes.map(function(axis) {
            axis.draw(dragging);
        });

        this.series()
            .map(function(series) {
                series.draw(dragging);
            });
    };

    this.recalculateScales = function() {
        scales.map(function(scale) {
            var zx = zoomScale != scale;
            if (zx) {
                scale.initialize();
            }
        });
    };

    this.zoomable = function(scale) {
        zoomable = true;
        zoomScale = scale;
        return this;
    };

    this.initZoom = function() {
        this.zoom = d3.behavior.zoom()
            .on("zoom", self.dragging.bind(self));

        this.zoom.x(zoomScale.scale);

        if (!this.zoomExists()) {
            this.chart.append("rect")
                .attr("class", "zoompane")
                .attr("width", this.width())
                .attr("height", this.height() - this.margin()
                    .top - this.margin()
                    .bottom)
                .style("fill", "none")
                .style("pointer-events", "all");
        }

        this.chart.select('.zoompane')
            .call(this.zoom);
    };

    this.zoomExists = function() {
        var z = this.chart.selectAll('.zoompane');
        return z[0].length;
    };

    this.dragging = function() {
        self.draw(true);
    };

    this.barPadding = function(_) {
        if (!arguments.length) {
            return barPadding();
        }
        barPadding = d3.functor(_);
        return this;
    };

    this.margin = function(_) {
        if (!arguments.length) {
            return this._margin;
        }
        this._margin = _;
        return this;
    };

    this.clipPath = function() {

        return this.name.split(' ')
            .join('_') + "clip";
    };


    /**
     * This function takes a data point, and creates a class name for insight to identify this particular key
     * If the parameter is not an object (just a value in an array) then there is no need for this particular class so blank is returned.
     * @returns {string} return - A class name to identify this point and any other points taking the same value in other charts.
     * @param {object} data - The input point
     */
    this.dimensionSelector = function(d) {

        var result = d.key.replace ? "in_" + d.key.replace(/[^A-Z0-9]/ig, "_") : "";

        return result;
    };



    this.click = function(element, value) {
        if (this.dimension) {
            var selected = d3.select(element)
                .classed('selected');

            d3.selectAll('.' + self.dimensionSelector(value))
                .classed('selected', !selected);

            this.clickEvent(this, value);
        }
    };

    this.tooltip = function() {

        this.tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) {
                return "&lt;span class='tipvalue'>" + d + "&lt;/span>";
            });

        this.chart.call(this.tip);

        return this;
    };

    this.mouseOver = function(chart, item, d) {

        var tooltip = $(item)
            .find('.tooltip')
            .first()
            .text();

        this.tip.show(tooltip);

        d3.select(item)
            .classed("active", true);
    };

    this.mouseOut = function(chart, item, d) {
        this.tip.hide(d);

        d3.select(item)
            .classed("active", false);
    };

    this.title = function(_) {
        if (!arguments.length) {
            return title;
        }

        title = _;
        return this;
    };

    this.width = function(_) {
        if (!arguments.length) {
            return width();
        }

        width = d3.functor(_);
        return this;
    };

    this.height = function(_) {
        if (!arguments.length) {
            return height();
        }
        height = d3.functor(_);
        return this;
    };

    this.series = function(_) {
        if (!arguments.length) {
            return series;
        }
        series = _;
    };


    this.scales = function(_) {
        if (!arguments.length) {
            return scales;
        }
        scales = _;
    };


    this.addHorizontalScale = function(type, typeString, direction) {
        var scale = new Scale(this, type, direction, typeString);
    };


    this.addHorizontalAxis = function(scale) {
        var axis = new Axis(this, scale, 'h', 'left');
    };


    this.autoMargin = function(_) {
        if (!arguments.length) {
            return autoMargin;
        }
        autoMargin = _;
        return this;
    };
}



Chart.prototype.calculateLabelMargin = function() {

    var canvas = this.measureCanvas;
    var max = 0;

    this.series()
        .forEach(function(series) {
            var m = series.maxLabelDimensions(canvas);
            max = m > max ? m : max;
        });

    this.margin()
        .bottom = max;
};


// Helper functions for adding series without having to create the scales & axes yourself (move to builder class?)

Chart.prototype.addColumnSeries = function(series) {

    var x = new Scale(this, "", d3.scale.ordinal(), 'h', 'ordinal');
    var y = new Scale(this, "", d3.scale.linear(), 'v', 'linear');

    var stacked = series.stacked ? true : false;

    var s = new ColumnSeries("", this, series.data, x, y, series.color)
        .stacked(stacked);

    s.series = [series];

    this.series()
        .push(s);

    return s;
};
</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Tue Jun 24 2014 09:52:19 GMT+0100 (BST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
