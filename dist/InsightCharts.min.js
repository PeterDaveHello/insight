/*! InsightCharts 19-03-2014 */
function Legend(a,b,c,d){BaseChart.call(this,a,b,c,d);this.dataset=function(){return this.group},this.init=function(){this.createChart();var a=this.chart.selectAll(".legend").data(this.dataset()).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+(20*b+5*b)+")"});a.append("rect").attr("x",0).attr("width",20).attr("height",20).attr("rx",10).attr("ry",10).style("fill",function(a){return a.color}),a.append("text").attr("x",25).attr("y",10).attr("dy",".35em").text(function(a){return a.label})},this.draw=function(){}}function BarChart(a,b,c,e){BaseChart.call(this,a,b,c,e);var f=this;this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this.xFormatFunc=function(a){return a},this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(0).tickPadding(10).tickFormat(function(a){return f._yAxisFormat(a)}),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(0).tickPadding(10).tickFormat(function(a){return f.xFormatFunc(a)}),this.xAxisFormat=function(a){return this.xFormatFunc=a,this},this.labelAnchoring=function(){return this.invert()?"start":"end"},this.initializeAxes=function(){this.x.domain(this.keys()).rangeRoundBands([0,this.width()-this.margin().left-this.margin().right],.2),this.y.domain([0,this.findMax()]).range([this.height()-this.margin().top-this.margin().bottom,0])},this.init=function(){var a=this;this.createChart(),this.initializeAxes();var b=this.chart.selectAll("rect.bar").data(this.dataset()).enter().append("rect").attr("class","bar").attr("x",function(b){return a.x(a._keyAccessor(b))}).attr("y",function(b){return a.y(a._valueAccessor(b))}).attr("width",function(){return a.x.rangeBand()}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(a._valueAccessor(b))}).attr("fill",this._barColor).on("mouseover",function(b){a.mouseOver(a,this,b)}).on("mouseout",function(b){a.mouseOut(a,this,b)});b.append("svg:text").text(function(b){return a._tooltipFormat(a._valueAccessor(b))}).attr("class","tipValue"),b.append("svg:text").text(function(){return a.tooltipLabel()}).attr("class","tipLabel"),this._targets.length&&this.drawTargets(),this.chart.append("g").attr("class","y-axis").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px"),this.chart.append("g").attr("transform","translate(0,"+(a.height()-a.margin().bottom-a.margin().top)+")").call(this.xAxis).selectAll("text").attr("class","x-axis").style("text-anchor","end").style("font-size","12px").on("mouseover",function(){a.setHover(this)}).on("mouseout",function(){a.removeHover(this)}).on("click",function(b){return a.filterClick(this,b)}).attr("transform",function(){return"rotate(-90,0,15)"}),this._ranges.length&&this.drawRanges()},this.draw=function(){var a=this;a._redrawAxes&&this.y.domain([0,a.findMax()]).range([this.height()-this.margin().top-this.margin().bottom,0]);var b=a.chart.selectAll("rect").data(this.dataset()).transition().duration(a.duration).attr("x",function(b){return a.x(a._keyAccessor(b))}).attr("y",function(b){return a.y(a._valueAccessor(b))}).attr("width",function(){return a.x.rangeBand()}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(a._valueAccessor(b))});b.selectAll("text.tipValue").text(function(b){return a._tooltipFormat(a._valueAccessor(b))}),b.selectAll("text.tipLabel").text(function(){return a.tooltipLabel()}),this._targets.length&&this.updateTargets(),this.chart.selectAll("g.y-axis").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333")},this.drawTargets=function(){var a,b=this,c=function(a){return b.x(b._keyAccessor(a))},d=function(c){return b.y(a(c))},e=function(){return b.x.rangeBand()},f=function(a){b.mouseOver(b,this,a)},g=function(a){b.mouseOut(b,this,a)},h=function(c){return b._tooltipFormat(a(c))},i=function(){return b._targets[j].label};for(var j in this._targets){a=b._targets[j].calculation;var k=this.chart.selectAll("rect.target").data(this.dataset()).enter().append("rect").attr("class","target "+b._targets[j].name+"class").attr("x",c).attr("y",d).attr("width",e).attr("height",4).attr("fill",b._targets[j].color).on("mouseover",f).on("mouseout",g);k.append("svg:text").text(h).attr("class","tipValue"),k.append("svg:text").text(i).attr("class","tipLabel")}},this.drawRanges=function(){var a,b=this,c=function(a){return b.x(b._keyAccessor(a))},e=function(c){return b.y(a(c))};for(var f in this._ranges){a=b._ranges[f].calculation(d);var g=d3.svg.line().x(c).y(e);this.chart.append("svg:path").attr("d",g(this.dataset())).attr("stroke",b._ranges[f].color).attr("stroke-width",1).attr("fill","none")}},this.updateTargets=function(){var a,b=this,c=function(c){return b.y(a(c))},d=function(c){return b._tooltipFormat(a(c))},e=function(){return b._targets[f].label};for(var f in this._targets){a=b._targets[f].calculation;var g=this.chart.selectAll("rect.target").data(this.dataset()).transition().duration(b.duration).attr("y",c);g.selectAll("text.tipValue").text(d).attr("class","tipValue"),g.selectAll("text.tipLabel").text(e).attr("class","tipLabel")}}}function GroupedBarChart(a,b,c,d){BaseChart.call(this,a,b,c,d);var e=this;this.groupNames=[],this.x=d3.scale.ordinal(),this.subX=d3.scale.ordinal(),this.y=d3.scale.linear(),this.xFormatFunc=function(a){return a},this.color=d3.scale.ordinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(0).tickPadding(10),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(0).tickPadding(10).tickFormat(function(a){return e.xFormatFunc(a)}),this.xAxisFormat=function(a){return this.xFormatFunc=a,this},this.labelAnchoring=function(){return this.invert()?"start":"end"},this.groupNames=function(a){return arguments?(this._groupNames=a,this):this._groupNames},this.yScaleMax=function(){var a=d3.max(this.dataset(),function(a){var b=0;return b=b<a.value.Total?a.value.Total:b});return a},this.initializeAxes=function(){this.x.domain(this.keys()).rangeRoundBands([0,this.width()-this.margin().left-this.margin().right],.2),this.subX.domain(this._groupNames).rangeRoundBands([0,this.x.rangeBand()],.1),this.y.domain([0,this.yScaleMax()]).range([this.height()-this.margin().top-this.margin().bottom,0])},this.init=function(){var a=this;this.createChart(),this.initializeAxes();var b=this.chart.selectAll(".group").data(this.dataset()).enter().append("g").attr("class","group").attr("transform",function(b){return"translate("+a.x(a._keyAccessor(b))+",0)"}),c=b.append("rect").attr("class","total").attr("width",this.x.rangeBand()).attr("x",0).attr("y",function(b){return a.y(b.value.Total)}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(b.value.Total)}).attr("fill","silver").on("mouseover",function(b){a.mouseOver(a,this,b)}).on("mouseout",function(b){a.mouseOut(a,this,b)});c.append("svg:text").text(function(){return a.tooltipLabel()}).attr("class","tipLabel"),c.append("svg:text").text(function(b){return a._tooltipFormat(b.value.Total)}).attr("class","tipValue");var d=b.selectAll("rect.subbar").data(function(a){var b=[];for(var c in a.value.Groups)b.push({key:c,value:a.value.Groups[c].Value});return b});d.enter().append("rect").attr("class","subbar").attr("width",this.subX.rangeBand()).attr("x",function(b){return a.subX(b.key)}).attr("y",function(b){return a.y(b.value)}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(b.value)}).attr("fill",function(b){return a.color(b.key)}).on("mouseover",function(b){a.mouseOver(a,this,b)}).on("mouseout",function(b){a.mouseOut(a,this,b)}),d.append("svg:text").text(function(b){return a._tooltipFormat(a._valueAccessor(b))}).attr("class","tipValue"),d.append("svg:text").text(function(){return a.tooltipLabel()}).attr("class","tipLabel"),this.chart.append("g").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333"),this.chart.append("g").attr("transform","translate(0,"+(a.height()-a.margin().bottom-a.margin().top)+")").call(this.xAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333").attr("transform",function(){return"rotate(-90,0,15)"}).on("click",function(b){return a.filterClick(this,b)});var e=this.chart.selectAll(".legend").data(this._groupNames).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+20*b+")"});e.append("rect").attr("x",this.width()-this.margin().right/2).attr("width",18).attr("height",18).style("fill",this.color),e.append("text").attr("x",this.width()-this.margin().right/2-10).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(a){return a})},this.draw=function(){var a=this,b=this.chart.selectAll("g.group").data(this.dataset());b.selectAll("rect.total").transition().duration(a.duration).attr("y",function(b){return a.y(b.value.Total)}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(b.value.Total)}),b.selectAll("rect.subbar").data(function(a){var b=[];for(var c in a.value.Groups)b.push({key:c,value:a.value.Groups[c].Value});return b}).transition().duration(a.duration).attr("y",function(b){return a.y(b.value)}).attr("height",function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(b.value)})}}function StackedBarChart(a,b,c,d){BaseChart.call(this,a,b,c,d);var e=this;this.x=d3.scale.ordinal(),this.y=d3.scale.linear(),this.xFormatFunc=function(a){return a},this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(0).tickPadding(10).tickFormat(function(a){return e._yAxisFormat(a)}),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(0).tickPadding(10).tickFormat(function(a){return e.xFormatFunc(a)}),this.xAxisFormat=function(a){return this.xFormatFunc=a,this},this.labelAnchoring=function(){return this.invert()?"start":"end"},this.initializeAxes=function(){this.x.domain(this.keys()).rangeRoundBands([0,this.width()-this.margin().left-this.margin().right],.2),this.y.domain([0,this.findMax()]).range([this.height()-this.margin().top-this.margin().bottom,0])},this.addSeries=function(a){return arguments.length?(this._series=a,this):this._series},this.calculateYPos=function(a,b){return b.yPos||(b.yPos=0),b.yPos+=a(b),b.yPos},this.init=function(){var a=this;this.createChart(),this.initializeAxes();var b=this.chart.selectAll("g").data(this.dataset());b.enter().append("g").attr("class","bargroup");var c,d=b.selectAll("rect.bar"),e=function(b){return a.x(a._keyAccessor(b))},f=function(b){return a.y(a.calculateYPos(c,b))},g=function(){return a.x.rangeBand()},h=function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(c(b))},i=function(b){a.mouseOver(a,this,b)},j=function(b){a.mouseOut(a,this,b)},k=function(b){return a._tooltipFormat(c(b))},l=function(){return a._series[m].label};for(var m in this._series)c=this.cumulative()?a._series[m].cumulative:a._series[m].calculation,d=b.append("rect").attr("class",a._series[m].name+"class bar").attr("x",e).attr("y",f).attr("width",g).attr("height",h).attr("fill",a._series[m].color).on("mouseover",i).on("mouseout",j),d.append("svg:text").text(k).attr("class","tipValue"),d.append("svg:text").text(l).attr("class","tipLabel");if(this.chart.append("g").attr("class","y-axis").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333"),this.chart.append("g").attr("transform","translate(0,"+(a.height()-a.margin().bottom-a.margin().top)+")").call(this.xAxis).selectAll("text").attr("class","x-axis").style("text-anchor","end").style("font-size","12px").attr("transform",function(){return"rotate(-90,0,15)"}).on("mouseover",function(){a.setHover(this)}).on("mouseout",function(){a.removeHover(this)}).on("click",function(b){return a.filterClick(this,b)}),this._targets.length){var n=function(b){return a.x(a._keyAccessor(b))+a.x.rangeBand()/4},o=function(b){return a.y(c(b))},p=function(){return a.x.rangeBand()/2};k=function(b){return a._tooltipFormat(c(b))},l=function(){return a._targets[q].label};for(var q in this._targets){c=this.cumulative()?a._targets[q].cumulative:a._targets[q].calculation;var r=b.append("rect").attr("class",a._targets[q].name+"class target").attr("x",n).attr("y",o).attr("width",p).attr("height",4).attr("fill",a._targets[q].color).on("mouseover",i).on("mouseout",j);r.append("svg:text").text(k).attr("class","tipValue"),r.append("svg:text").text(l).attr("class","tipLabel")}}},this.draw=function(){var a=this;a.redrawAxes()&&this.y.domain([0,d3.round(a.findMax(),1)]).range([this.height()-this.margin().top-this.margin().bottom,0]);var b=this.chart.selectAll("g.bargroup").data(this.dataset()).each(function(a){a.yPos=0}),c=this._valueAccessor,d=function(b){return a.x(a._keyAccessor(b))},e=function(b){return a.y(a.calculateYPos(c,b))},f=function(b){return a.height()-a.margin().top-a.margin().bottom-a.y(c(b))},g=function(b){return a._tooltipFormat(c(b))},h=function(){return a._series[i].label};for(var i in this._series){c=this.cumulative()?a._series[i].cumulative:a._series[i].calculation;var j=b.selectAll("."+a._series[i].name+"class.bar").transition().duration(a.duration).attr("x",d).attr("y",e).attr("height",f);j.selectAll("text.tipValue").text(g),j.selectAll("text.tipLabel").text(h)}if(this._targets.length){var k=function(b){return a.y(c(b))};g=function(b){return a._tooltipFormat(c(b))},h=function(){return a._targets[l].label};for(var l in this._targets){c=this.cumulative()?a._targets[l].cumulative:a._targets[l].calculation;var m=b.selectAll("."+a._targets[l].name+"class.target").transition().duration(a.duration).attr("y",k);m.selectAll("text.tipValue").text(g).attr("class","tipValue"),m.selectAll("text.tipLabel").text(h).attr("class","tipLabel")}}this.chart.selectAll(".y-axis").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333")}}function TimeLine(a,b,c,d){BaseChart.call(this,a,b,c,d);this.maxRange=d3.max(this.dataset()).value,this.range=[this.dimension.Dimension.bottom(1)[0].Date,this.dimension.Dimension.top(1)[0].Date],this.brushColor=function(a){return arguments.length?(this._brushColor=a,this):this._brushColor},this.initializeAxes=function(){this.x=d3.scale.linear().domain([0,this.maxRange]).range([0,this.width()-160]),this.y=d3.time.scale().domain(this.range).range([0,this.height()]),this.yAxis=d3.svg.axis().scale(this.y).tickSize(0).orient("right")},this.display=function(){var a=this,b=a.brush.extent()[0],c=a.brush.extent()[1];b.getTime()!=c.getTime()?(this.dimension.Dimension.filter(function(a){return a>=b&&c>=a}),a.mini.select(".brush").call(a.brush.extent([b,c]))):this.dimension.Dimension.filterAll();this.group.Data();this.group.Data(this.group.Data())},this.init=function(){var a=this;this.createChart(),this.initializeAxes(),this.mini=this.chart.append("g").attr("width",function(){return a.width()}).attr("height",function(){return a.height()}).attr("class","mini"),this.brush=d3.svg.brush().y(this.y).on("brush",function(){a.display()}),a.mini.append("g").selectAll(".miniItems").data(this.dataset()).enter().append("rect").attr("class","minitems").attr("x",60).attr("y",function(b){return a.y(a._keyAccessor(b))}).attr("width",function(b){return a.x(a._valueAccessor(b))}).attr("height",3).attr("fill",a._barColor),a.mini.append("g").attr("class","y axis").style("font-size","11px").call(a.yAxis),a.mini.append("g").attr("class","x brush").call(a.brush).selectAll("rect").attr("width",a.width()).attr("fill",a._brushColor).style("opacity","0.5")},this.draw=function(){var a=this;a.chart.selectAll("rect.mini").data(this.dataset()).transition().duration(a.duration).attr("y",function(b){return a.y(a._keyAccessor(b))}).attr("width",function(b){return a.x(a._valueAccessor(b))})}}function PartitionChart(a,b,c,d){this.element=b,this.group=d;var e=1120,f=600,g=d3.scale.linear().range([0,e]),h=d3.scale.linear().range([0,f]);this.vis=d3.select(this.element).append("div").attr("class","chart").style("width",e+"px").style("height",f+"px").append("svg:svg").attr("width",e).attr("height",f),this.partition=d3.layout.partition().children(function(a){return a.values}).value(function(a){return a.ProjectedRevenue}),this.init=function(){function a(a){return"translate(8,"+a.dx*j/2+")"}function b(b){if(b.children){i=(b.y?e-40:e)/(1-b.y),j=f/b.dx,g.domain([b.y,1]).range([b.y?40:0,e]),h.domain([b.x,b.x+b.dx]);var c=d.transition().duration(d3.event.altKey?7500:750).attr("transform",function(a){return"translate("+g(a.y)+","+h(a.x)+")"});c.select("rect").attr("width",b.dy*i).attr("height",function(a){return a.dx*j}),c.select("text").attr("transform",a).style("opacity",function(a){return a.dx*j>12?1:0}),d3.event.stopPropagation()}}var c=this,d=this.vis.selectAll("g").data(c.partition.nodes(this.group())).enter().append("svg:g").attr("transform",function(a){return"translate("+g(a.y)+","+h(a.x)+")"}).on("click",b),i=e/this.group().dx,j=f/1;d.append("svg:rect").attr("width",this.group().dy*i).attr("height",function(a){return a.dx*j}).attr("class",function(a){return a.children?"parent":"child"}).attr("fill","rgb(135, 158, 192)").style("stroke","#fff"),d.append("svg:text").attr("transform",a).attr("dy",".35em").attr("dx","2em").attr("fill","#ecf0f1").style("font-size","13px").style("opacity",function(a){return a.dx*j>12?1:0}).text(function(a){return a.key})}}var Group=function(a,b){this.Data=ko.observable(a),this.cumulative=b};Group.prototype.filterFunction=function(a){return arguments.length?(this._filterFunction=a,this):this._filterFunction},Group.prototype.getData=function(){var a=this.Data().all();return this._filterFunction&&(a=this.Data().all().filter(this._filterFunction)),a};var Dimension=function(a,b,c){this.Dimension=b,this.Name=a,this.Filters=ko.observableArray(),this.Keys=this.Dimension.group().all().map(function(a){return a.key}),this.displayFunction=c?c:function(a){return a}},ChartGroup=function(a){this.Name=a,this.Charts=ko.observableArray(),this.Dimensions=ko.observableArray(),this.Groups=ko.observableArray(),this.CumulativeGroups=ko.observableArray()};ChartGroup.prototype.addChart=function(a){return a.init(),a.filterEvent=this.chartFilterHandler.bind(this),this.Charts.push(a),a},ChartGroup.prototype.addDimension=function(a,b,c,d){var e=new Dimension(b,a.dimension(c),d);return this.Dimensions.push(e),e},ChartGroup.prototype.chartFilterHandler=function(a,b,c){if(b.Filters){var d=-1!=b.Filters.indexOf(c);d?b.Filters.remove(c):b.Filters.push(c)}0===b.Filters().length?b.Dimension.filterAll():b.Dimension.filter(function(a){return-1!=b.Filters().indexOf(a)}),this.CumulativeGroups().forEach(function(a){var b=0,c=0,d=0,e=a.getData();e.forEach(function(a){b+=a.value.Current,c+=a.value.Renewal,d+=a.value.Budget,a.value.CurrentTotal=b,a.value.RenewalTotal=c,a.value.BudgetTotal=d})}),a.Data(a.Data())},ChartGroup.prototype.addSumGrouping=function(a,b){var c=a.Dimension.group().reduceSum(b),d=new Group(c,!1);return d.Data.subscribe(function(){for(var a=0;a<this.Charts().length;a++)this.Charts()[a].draw()},this),this.Groups.push(d),d},ChartGroup.prototype.addCumulativeGrouping=function(a){a.Data.subscribe(function(){for(var a=0;a<this.Charts().length;a++)this.Charts()[a].draw()},this),this.Groups.push(a);var b=0,c=0,d=0;this.CumulativeGroups.push(a),a.getData().forEach(function(a){b+=a.value.Current,c+=a.value.Renewal,d+=a.value.Budget,a.value.CurrentTotal=b,a.value.RenewalTotal=c,a.value.BudgetTotal=d})},ChartGroup.prototype.addCustomGrouping=function(a){return a.Data.subscribe(function(){for(var a=0;a<this.Charts().length;a++)this.Charts()[a].draw()},this),this.Groups.push(a),a};var BaseChart=function(a,b,c,d){this.element=b,this.dimension=c,this.group=d,this._name=a,this._displayName=a,this._keyAccessor=function(a){return a.key},this._barColor="#acc3ee",this._valueAccessor=function(a){return a.value},this._limitFunction=function(){return!0},this._labelAccessor=function(a){return a.key},this._tooltipFormat=function(a){return a},this._yAxisFormat=function(a){return a},this._currentMax=0,this._cumulative=!1,this._labelFontSize="11px",this._targets=[],this._series=[],this._ranges=[],this._redrawAxes=!1,this.isFiltered=!1,this._margin={top:0,bottom:0,left:0,right:0},this.duration=500,this.filters=[],this._labelPadding=20,this.hasTooltip=!1,this.tooltipText="",this._invert=!1};BaseChart.prototype.displayName=function(a){return arguments.length?(this._displayName=a,this):this._displayName},BaseChart.prototype.width=function(a){return arguments.length?(this._width=a,this):this._width},BaseChart.prototype.height=function(a){return arguments.length?(this._height=a,this):this._height},BaseChart.prototype.y=function(a){return arguments.length?(this._y=a,this):this._y},BaseChart.prototype.x=function(a){return arguments.length?(this._x=a,this):this._x},BaseChart.prototype.cumulative=function(a){return arguments.length?(this._cumulative=a,this):this._cumulative},BaseChart.prototype.updateMax=function(a){var b=0;this._currentMax=0;var c;if(this._series.length)for(var d in this._series)c=this.cumulative()?this._series[d].cumulative:this._series[d].calculation,b+=c(a),this._currentMax=b>this._currentMax?b:this._currentMax;else b+=this._valueAccessor(a),this._currentMax=b>this._currentMax?b:this._currentMax;if(this._targets.length)for(var e in this._targets)c=this.cumulative()?this._targets[e].cumulative:this._targets[e].calculation,b=c(a),this._currentMax=b>this._currentMax?b:this._currentMax;return this._currentMax},BaseChart.prototype.findMax=function(){var a=this,b=d3.max(this.dataset(),function(b){return a.updateMax(b)});return b},BaseChart.prototype.zeroValueEntry=function(a){var b,c=0;if(this._series.length)for(var d in this._series)b=this.cumulative()?this._series[d].cumulative:this._series[d].calculation,c|=Math.round(b(a),1)>0;else c|=Math.round(this._valueAccessor(a),1)>0;if(this._targets.length)for(var e in this._targets)b=this.cumulative()?this._targets[e].cumulative:this._targets[e].calculation,c|=Math.round(b(a),1)>0;return c},BaseChart.prototype.keys=function(){var a=this,b=[];return b=this._redrawAxes?this.dataset().filter(function(b){return a.zeroValueEntry(b)}).map(this._keyAccessor):this.dataset().map(this._keyAccessor)},BaseChart.prototype.targets=function(a){return arguments.length?(this._targets=a,this):this._targets},BaseChart.prototype.ranges=function(a){return arguments.length?(this._ranges=a,this):this._ranges},BaseChart.prototype.createChart=function(){this.chart=d3.select(this.element).append("svg").attr("class","chart"),this.chart.attr("width",this.width()).attr("height",this.height()),this.chart=this.chart.append("g").attr("transform","translate("+this.margin().left+","+this.margin().top+")"),this.tooltip()},BaseChart.prototype.topResults=function(a){return arguments.length?(this._topResults=a,this):this._topResults},BaseChart.prototype.dataset=function(){return this.group.getData().filter(this._limitFunction)},BaseChart.prototype.keyAccessor=function(a){return arguments.length?(this._keyAccessor=a,this):this._keyAccessor},BaseChart.prototype.labelAccessor=function(a){return arguments.length?(this._labelAccessor=a,this):this._labelAccessor},BaseChart.prototype.tooltipFormat=function(a){return arguments.length?(this._tooltipFormat=a,this):this._tooltipFormat},BaseChart.prototype.yAxisFormat=function(a){return arguments.length?(this._yAxisFormat=a,this):this._yAxisFormat},BaseChart.prototype.valueAccessor=function(a){return arguments.length?(this._valueAccessor=a,this):this._valueAccessor},BaseChart.prototype.redrawAxes=function(a){return arguments.length?(this._redrawAxes=a,this):this._redrawAxes},BaseChart.prototype.margin=function(a){return arguments.length?(this._margin=a,this):this._margin},BaseChart.prototype.draw=function(){},BaseChart.prototype.init=function(){},BaseChart.prototype.invert=function(a){return arguments.length?(this._invert=a,this):this._invert},BaseChart.prototype.setHover=function(a){d3.select(a).classed("active",!0)},BaseChart.prototype.removeHover=function(a){d3.select(a).classed("active",!1)},BaseChart.prototype.mouseOver=function(a,b){if(a.hasTooltip){var c=$(b).find(".tipValue").first().html(),d=$(b).find(".tipLabel").first().html();a.tip.show({label:d,value:c})}this.setHover(b)},BaseChart.prototype.mouseOut=function(a,b,c){a.hasTooltip&&a.tip.hide(c),this.removeHover(b)},BaseChart.prototype.labelColor=function(a){return arguments.length?(this._labelColor=a,this):this._labelColor},BaseChart.prototype.barColor=function(a){return arguments.length?(this._barColor=a,this):this._barColor},BaseChart.prototype.tooltipLabel=function(a){return arguments.length?(this.toolTipText=a,this):this.toolTipText},BaseChart.prototype.tooltip=function(){return this.hasTooltip=!0,this.tip=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<span class='tiplabel'>"+a.label+": </span><span class='tipvalue'>"+a.value+"</span>"}),this.chart.call(this.tip),this},BaseChart.prototype.filterKey=function(){},BaseChart.prototype.limitFunction=function(a){return arguments.length?(this._limitFunction=a,this):this._limitFunction},BaseChart.prototype.labelPadding=function(a){return arguments.length?(this._labelPadding=a,this):this._labelPadding},BaseChart.prototype.labelFontSize=function(a){return arguments.length?(this._labelFontSize=a,this):this._labelFontSize},BaseChart.prototype.xBounds=function(){var a=this.invert()?this.margin().right:this.margin().left,b=this.width()-(this.margin().right+this.margin().left);return{start:a,end:b}},BaseChart.prototype.yBounds=function(){var a=this.invert()?this.margin().top:this.margin().bottom,b=this.height()-(this.margin().top+this.margin().bottom);return{start:a,end:b}},BaseChart.prototype.labelAnchoring=function(){return this.invert()?"end":"start"},BaseChart.prototype.filterFunction=function(a){var b=a.key?a.key:a;return b},BaseChart.prototype.filterClick=function(a,b){d3.select(a).classed("selected")?d3.select(a).classed("selected",!1):d3.select(a).classed("selected",!0);var c=this.filterFunction(b);this.filterEvent(this.group,this.dimension,c)},BaseChart.prototype.filterEvent=function(){},BaseChart.prototype.updateTargets=function(){},BaseChart.prototype.drawTargets=function(){},Legend.prototype=Object.create(BaseChart.prototype),Legend.prototype.constructor=Legend,BarChart.prototype=Object.create(BaseChart.prototype),BarChart.prototype.constructor=BarChart,GroupedBarChart.prototype=Object.create(BaseChart.prototype),GroupedBarChart.prototype.constructor=GroupedBarChart,StackedBarChart.prototype=Object.create(BaseChart.prototype),StackedBarChart.prototype.constructor=StackedBarChart,TimeLine.prototype=Object.create(BaseChart.prototype),TimeLine.prototype.constructor=TimeLine;var RowChart=function(a,b,c,d){BaseChart.call(this,a,b,c,d);var e=this;return this.x=d3.scale.linear(),this.y=d3.scale.ordinal(),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(0).tickPadding(10),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickSize(0).tickPadding(10).tickFormat(function(a){return e.xFormatFunc(a)}),this.initializeAxes=function(){this.x.domain([0,this.findMax()]).range([0,this.xBounds().end]),this.y.domain(this.keys()).rangeRoundBands([0,this.height()],.2)},this.barXPosition=function(a){var b=0;return e.invert()&&(b=e.xBounds().end-e.x(e._valueAccessor(a))),b},this.init=function(){var a=this;this.createChart(),this.initializeAxes();var b=this.chart.append("g").selectAll("rect").data(this.dataset()).enter().append("rect").attr("x",this.barXPosition).attr("y",function(b){return a.y(b.key)}).attr("width",function(b){return a.x(a._valueAccessor(b))}).attr("height",function(){return a.y.rangeBand()}).attr("fill",this.barColor()).on("click",function(b){a.filterClick(this,b)}).on("mouseover",function(b){a.mouseOver(a,this,b)}).on("mouseout",function(b){a.mouseOut(a,this,b)});this.chart.selectAll("rect").data(this.dataset()).exit().remove(),b.append("svg:text").text(function(b){return a._tooltipFormat(a._valueAccessor(b))}).attr("class","tipValue"),b.append("svg:text").text(function(){return a.tooltipLabel()}).attr("class","tipLabel"),this.chart.append("g").attr("class","y-axis").call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px")},this.draw=function(){var a=this;a._redrawAxes&&(this.y.domain(this.keys()).rangeRoundBands([0,this.height()],.2),this.yAxis=d3.svg.axis().scale(this.y).orient("left").tickSize(0).tickPadding(10),this.chart.selectAll("g.y-axis").transition().duration(a.duration).call(this.yAxis).selectAll("text").style("text-anchor","end").style("font-size","12px").style("fill","#333"));var b=a.chart.selectAll("rect").data(this.dataset()).transition().duration(a.duration).attr("width",function(b){return a.x(a._valueAccessor(b))});a._redrawAxes&&b.attr("y",function(b){return a.y(b.key)}).attr("height",function(){return a.y.rangeBand()})},this};RowChart.prototype=Object.create(BaseChart.prototype),RowChart.prototype.constructor=RowChart,PartitionChart.prototype=Object.create(BaseChart.prototype),PartitionChart.prototype.constructor=PartitionChart;